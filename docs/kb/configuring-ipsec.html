<!--
title: Untitled Page
description: 
published: true
date: 2022-10-04T18:39:47.899Z
tags: 
editor: ckeditor
dateCreated: 2022-10-04T18:38:59.908Z
-->

<h1>Header</h1>
<p>Overview steps to create a VPN tunnel in Verge.IO</p>
<p>General Notes:</p>
<ul>
  <li>In Verge.io the DMZ is the basic routing between networks</li>
  <li>Every router gets a NIC + an IP address in the DMZ</li>
  <li>This is how traffic transverses from network to network inside the Verge.IO platform</li>
  <li>Each vnet is its own vxlan or vlan</li>
</ul>
<ol>
  <li>Reserve a static IP address on the Internal (LAN) network which will be used by the VPN connection on that network. &nbsp; In this example, I set 192.168.0.254 to be static on the internal network named Internal.</li>
</ol>
<p>&nbsp;</p>
<ul>
  <li>For Type, set to Static</li>
  <li>For IP Address, choose one of the available IP addresses in the system.&nbsp; If there are not any free, available IP addresses, and additional one is necessary.</li>
</ul>
<ol>
  <li>Create a new VPN connection.&nbsp;&nbsp;</li>
</ol>
<p>Administrators will create a new VPN connection by navigating to:</p>
<p>Main Dashboard &gt; Networks &gt; VPNs and clicking <strong>New VPN</strong></p>
<p>&nbsp;</p>
<p>These settings are variable based on each connection, but are important to define</p>
<ul>
  <li>For Network, Layer 2 - configure as required by the connection</li>
  <li>For Network, MTU - configure as required by the connection</li>
  <li>For Network, Interface Network - <i>this should be the network being bridged to the VPN Connection</i>.</li>
  <li>For Network, set the IP Address Type to Static</li>
  <li>For Network Router, IP Address, use the IP address reserved in Step 1.</li>
</ul>
<p>If Necessary, from the newly created VPN Dashboard, click on Edit IPSec to edit the IPSec configuration</p>
<p>Edit the IPSec configuration only as necessary with connection specific information</p>
<p>2c Click on IPSec Tunnels to start creating the IPSec Tunnel between the Verge.io environment and the remote site.</p>
<p>.</p>
<ul>
  <li>For Remote Gateway - configure as required by the connection</li>
  <li>For Phase 1 Proposal (Authentication), define the Authentication Method and Pre-Shared Key with connection specific information</li>
</ul>
<p>When completing the Phase 1 setup, it will automatically launch you into configuring Phase 2.</p>
<p>2d -&nbsp; Click into the Phase 1 settings to begin configuring&nbsp; Phase 2 settings, If navigating manually, Main Dashboard&gt;Networks Dashboard&gt;VPNs&gt;<i>VPN Connection</i>&gt;Phase 1s&gt; , highlight the Phase 1 created previously and click ‘View P2s’</p>
<p>&nbsp;</p>
<ul>
  <li>For Mode, set to Tunnel</li>
  <li>For Local Network, configure as required</li>
  <li>For Remote Network - configure as required by the connection</li>
  <li>For Phase 2 Proposal, configure as required by the connection</li>
</ul>
<p>This will automatically create some rules on the VPN network.</p>
<p>Review the rules to verify their configuration</p>
<p>&nbsp;</p>
<p>It should have created the following rules automatically:</p>
<ul>
  <li>Accept incoming, named Allow IKE, Protocol UDP, Destination IP: My Router IP, Port: 500</li>
  <li>Accept incoming, named Allow IPSEC NAT - Traversal, UDP, Destination IP: My Router IP, Port 4500</li>
  <li>Accept incoming, named Allow ESP, ESP, Destination IP: My Router IP</li>
  <li>Accept incoming, named Allow AH, AH, Destination IP: My Router IP</li>
</ul>
<ol>
  <li>Assign a new virtual IP to the new VPN network from the external network.&nbsp; This will be the ‘public’ side of the VPN tunnel.</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>This should automatically create an outgoing route rule on the VPN network with that virtual IP address, which will have to have the rule applied.&nbsp; Verify that the rule is present and then Apply Rules to save the changes</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a default route rule for the new VPN network to define the default path outbound for traffic inside this network.</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create an sNAT traffic rule on the new VPN network to mask external traffic</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a general sNAT rule to work as a catchall for traffic from this network.</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a new Translate rule to allow traffic from the VPN tunnel to access this network</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a route rule on the internal network to send traffic properly out the VPN tunnel</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a new accept rule on the VPN network to allow traffic from the remote network in</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a new accept rule on the internal network to allow traffic from the remote network</li>
</ol>
<p>&nbsp;</p>
<ol>
  <li>Create a new accept rule on the VPN network to allow traffic&nbsp;</li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
